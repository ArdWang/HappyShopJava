更新2019/5/30日
修改以前的一些错误的BUG使得程序兼容
新增了一些代码